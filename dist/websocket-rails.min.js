!function t(n,e,i){function s(c,r){if(!e[c]){if(!n[c]){var h="function"==typeof require&&require;if(!r&&h)return h(c,!0);if(o)return o(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var a=e[c]={exports:{}};n[c][0].call(a.exports,function(t){var e=n[c][1][t];return s(e?e:t)},a,a.exports,t,n,e,i)}return e[c].exports}for(var o="function"==typeof require&&require,c=0;c<i.length;c++)s(i[c]);return s}({1:[function(t,n,e){(function(){var e=t("./websocket_rails");e.AbstractConnection=function(){function t(t,n){this.dispatcher=n,this.message_queue=[]}return t.prototype.close=function(){},t.prototype.trigger=function(t){return"connected"!==this.dispatcher.state?this.message_queue.push(t):this.send_event(t)},t.prototype.send_event=function(t){return null!=this.connection_id?t.connection_id=this.connection_id:void 0},t.prototype.on_close=function(t){var n;return this.dispatcher&&this.dispatcher._conn===this?(n=new e.Event(["connection_closed",t]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(n)):void 0},t.prototype.on_error=function(t){var n;return this.dispatcher&&this.dispatcher._conn===this?(n=new e.Event(["connection_error",t]),this.dispatcher.state="disconnected",this.dispatcher.dispatch(n)):void 0},t.prototype.on_message=function(t){return this.dispatcher&&this.dispatcher._conn===this?this.dispatcher.new_message(t):void 0},t.prototype.setConnectionId=function(t){this.connection_id=t},t.prototype.flush_queue=function(){var t,n,e,i;for(i=this.message_queue,n=0,e=i.length;e>n;n++)t=i[n],this.trigger(t);return this.message_queue=[]},t}(),n.exports=e}).call(this)},{"./websocket_rails":7}],2:[function(t,n,e){(function(){var e=t("./websocket_rails"),i=function(t,n){return function(){return t.apply(n,arguments)}};e.Channel=function(){function t(t,n,s,o,c){var r,h,u;this.name=t,this._dispatcher=n,this.is_private=s,this.on_success=o,this.on_failure=c,this._failure_launcher=i(this._failure_launcher,this),this._success_launcher=i(this._success_launcher,this),h=this.is_private?"websocket_rails.subscribe_private":"websocket_rails.subscribe",this.connection_id=null!=(u=this._dispatcher._conn)?u.connection_id:void 0,r=new e.Event([h,{channel:this.name},{connection_id:this.connection_id}],this._success_launcher,this._failure_launcher),this._dispatcher.trigger_event(r),this._callbacks={},this._token=void 0,this._queue=[]}return t.prototype.is_public=function(){return!this.is_private},t.prototype.destroy=function(){var t,n,i;return this.connection_id===(null!=(i=this._dispatcher._conn)?i.connection_id:void 0)&&(n="websocket_rails.unsubscribe",t=new e.Event([n,{channel:this.name},{connection_id:this.connection_id,token:this._token}]),this._dispatcher.trigger_event(t)),this._callbacks={}},t.prototype.bind=function(t,n){var e;return null==(e=this._callbacks)[t]&&(e[t]=[]),this._callbacks[t].push(n)},t.prototype.unbind=function(t){return delete this._callbacks[t]},t.prototype.trigger=function(t,n){var i;return i=new e.Event([t,n,{connection_id:this.connection_id,channel:this.name,token:this._token}]),this._token?this._dispatcher.trigger_event(i):this._queue.push(i)},t.prototype.dispatch=function(t,n){var e,i,s,o,c,r,h,u,a;if("websocket_rails.channel_token"===t){for(this._token=n.token,h=this._queue,s=0,c=h.length;c>s;s++)i=h[s],this._dispatcher.trigger_event(i);return this._queue=[]}if(null!=this._callbacks[t]){for(u=this._callbacks[t],a=[],o=0,r=u.length;r>o;o++)e=u[o],a.push(e(n));return a}},t.prototype._success_launcher=function(t){return null!=this.on_success?this.on_success(t):void 0},t.prototype._failure_launcher=function(t){return null!=this.on_failure?this.on_failure(t):void 0},t}(),n.exports=e}).call(this)},{"./websocket_rails":7}],3:[function(t,n,e){(function(){var e;e=t("./websocket_rails"),e.Event=function(){function t(t,n,e){var i;this.success_callback=n,this.failure_callback=e,this.name=t[0],this.data=t[1],i=t[2],null!=i&&(this.id=null!=i.id?i.id:65536*(1+Math.random())|0,this.channel=i.channel,this.token=i.token,this.connection_id=i.connection_id,null!=i.success&&(this.result=!0,this.success=i.success))}return t.prototype.is_channel=function(){return null!=this.channel},t.prototype.is_result=function(){return"undefined"!=typeof this.result},t.prototype.is_ping=function(){return"websocket_rails.ping"===this.name},t.prototype.serialize=function(){return JSON.stringify([this.name,this.data,this.meta_data()])},t.prototype.meta_data=function(){return{id:this.id,connection_id:this.connection_id,channel:this.channel,token:this.token}},t.prototype.run_callbacks=function(t,n){return this.success=t,this.result=n,this.success===!0?"function"==typeof this.success_callback?this.success_callback(this.result):void 0:"function"==typeof this.failure_callback?this.failure_callback(this.result):void 0},t}(),n.exports=e}).call(this)},{"./websocket_rails":7}],4:[function(t,n,e){(function(){var e=t("./websocket_rails"),i=function(t,n){function e(){this.constructor=t}for(var i in n)s.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},s={}.hasOwnProperty;e.HttpConnection=function(t){function n(t,e){this.dispatcher=e,n.__super__.constructor.apply(this,arguments),this._url="http://"+t,this._conn=this._createXMLHttpObject(),this.last_pos=0,this._conn.onreadystatechange=function(t){return function(){return t._parse_stream()}}(this),this._conn.addEventListener("load",this.on_close,!1),this._conn.open("GET",this._url,!0),this._conn.send()}return i(n,t),n.prototype.connection_type="http",n.prototype._httpFactories=function(){return[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}]},n.prototype.close=function(){return this._conn.abort()},n.prototype.send_event=function(t){return n.__super__.send_event.apply(this,arguments),this._post_data(t.serialize())},n.prototype._post_data=function(t){return $.ajax(this._url,{type:"POST",data:{client_id:this.connection_id,data:t},success:function(){}})},n.prototype._createXMLHttpObject=function(){var t,n,e,i,s,o;for(o=!1,n=this._httpFactories(),i=0,s=n.length;s>i;i++){e=n[i];try{o=e()}catch(c){t=c;continue}break}return o},n.prototype._parse_stream=function(){var t,n;return 3===this._conn.readyState?(t=this._conn.responseText.substring(this.last_pos),this.last_pos=this._conn.responseText.length,t=t.replace(/\]\]\[\[/g,"],["),n=JSON.parse(t),this.on_message(n)):void 0},n}(e.AbstractConnection),n.exports=e}).call(this)},{"./websocket_rails":7}],5:[function(t,n,e){(function(e){(function(){var i;i=t("./websocket_rails"),i=t("./event"),i=t("./abstract_connection"),i=t("./http_connection"),i=t("./websocket_connection"),i=t("./channel"),e.WebSocketRails=n.exports=i}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./abstract_connection":1,"./channel":2,"./event":3,"./http_connection":4,"./websocket_connection":6,"./websocket_rails":7}],6:[function(t,n,e){(function(){var e=t("./websocket_rails"),i=function(t,n){function e(){this.constructor=t}for(var i in n)s.call(n,i)&&(t[i]=n[i]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},s={}.hasOwnProperty;e.WebSocketConnection=function(t){function n(t,e){this.url=t,this.dispatcher=e,n.__super__.constructor.apply(this,arguments),this.url.match(/^wss?:\/\//)?console.log("WARNING: Using connection urls with protocol specified is depricated"):"https:"===window.location.protocol?this.url="wss://"+this.url:this.url="ws://"+this.url,this._conn=new WebSocket(this.url),this._conn.onmessage=function(t){return function(n){var e;return e=JSON.parse(n.data),t.on_message(e)}}(this),this._conn.onclose=function(t){return function(n){return t.on_close(n)}}(this),this._conn.onerror=function(t){return function(n){return t.on_error(n)}}(this)}return i(n,t),n.prototype.connection_type="websocket",n.prototype.close=function(){return this._conn.close()},n.prototype.send_event=function(t){return n.__super__.send_event.apply(this,arguments),this._conn.send(t.serialize())},n}(e.AbstractConnection),n.exports=e}).call(this)},{"./websocket_rails":7}],7:[function(t,n,e){(function(){var t,e=function(t,n){return function(){return t.apply(n,arguments)}};t=function(){function t(t,n){this.url=t,this.use_websockets=null!=n?n:!0,this.connection_stale=e(this.connection_stale,this),this.supports_websockets=e(this.supports_websockets,this),this.dispatch_channel=e(this.dispatch_channel,this),this.unsubscribe=e(this.unsubscribe,this),this.subscribe_private=e(this.subscribe_private,this),this.subscribe=e(this.subscribe,this),this.dispatch=e(this.dispatch,this),this.trigger_event=e(this.trigger_event,this),this.trigger=e(this.trigger,this),this.bind=e(this.bind,this),this.unbind=e(this.unbind,this),this.connection_established=e(this.connection_established,this),this.new_message=e(this.new_message,this),this.reconnect=e(this.reconnect,this),this.callbacks={},this.channels={},this.queue={},this.connect()}return t.prototype.connect=function(){return this.state="connecting",this.supports_websockets()&&this.use_websockets?this._conn=new t.WebSocketConnection(this.url,this):this._conn=new t.HttpConnection(this.url,this),this._conn.new_message=this.new_message},t.prototype.disconnect=function(){return this._conn&&(this._conn.close(),delete this._conn._conn,delete this._conn),this.state="disconnected"},t.prototype.reconnect=function(){var t,n,e,i,s;e=null!=(i=this._conn)?i.connection_id:void 0,this.disconnect(),this.connect(),s=this.queue;for(n in s)t=s[n],t.connection_id!==e||t.is_result()||this.trigger_event(t);return this.reconnect_channels()},t.prototype.new_message=function(n){var e,i;return e=new t.Event(n),e.is_result()?(null!=(i=this.queue[e.id])&&i.run_callbacks(e.success,e.data),this.queue[e.id]=null):e.is_channel()?this.dispatch_channel(e):this.dispatch(e),"connecting"===this.state&&"client_connected"===e.name?this.connection_established(e):void 0},t.prototype.connection_established=function(t){return this.state="connected",this._conn.setConnectionId(t.connection_id),this._conn.flush_queue(),null!=this.on_open?this.on_open(t.data):void 0},t.prototype.bind=function(t,n){var e;return null==(e=this.callbacks)[t]&&(e[t]=[]),this.callbacks[t].push(n)},t.prototype.unbind=function(t){return delete this.callbacks[t]},t.prototype.trigger=function(n,e,i,s){var o;return o=new t.Event([n,e,{connection_id:this.connection_id}],i,s),this.queue[o.id]=o,this._conn.trigger(o)},t.prototype.trigger_event=function(t){var n,e;return null==(n=this.queue)[e=t.id]&&(n[e]=t),this._conn.trigger(t),t},t.prototype.dispatch=function(t){var n,e,i,s,o;if(null!=this.callbacks[t.name]){for(s=this.callbacks[t.name],o=[],e=0,i=s.length;i>e;e++)n=s[e],o.push(n(t.data));return o}},t.prototype.subscribe=function(n,e,i){var s;return null==this.channels[n]?(s=new t.Channel(n,this,!1,e,i),this.channels[n]=s,s):this.channels[n]},t.prototype.subscribe_private=function(n,e,i){var s;return null==this.channels[n]?(s=new t.Channel(n,this,!0,e,i),this.channels[n]=s,s):this.channels[n]},t.prototype.unsubscribe=function(t){return null!=this.channels[t]?(this.channels[t].destroy(),delete this.channels[t]):void 0},t.prototype.dispatch_channel=function(t){return null!=this.channels[t.channel]?this.channels[t.channel].dispatch(t.name,t.data):void 0},t.prototype.supports_websockets=function(){return"function"==typeof WebSocket||"object"==typeof WebSocket},t.prototype.connection_stale=function(){return"connected"!==this.state},t.prototype.reconnect_channels=function(){var t,n,e,i,s;i=this.channels,s=[];for(e in i)n=i[e],t=n._callbacks,n.destroy(),delete this.channels[e],n=n.is_private?this.subscribe_private(e):this.subscribe(e),n._callbacks=t,s.push(n);return s},t}(),n.exports=t}).call(this)},{}]},{},[5]);